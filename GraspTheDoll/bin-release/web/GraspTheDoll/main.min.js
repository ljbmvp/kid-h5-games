var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function s(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(s.prototype=i.prototype,new s)}}(),StepType;!function(t){t[t.wait=0]="wait",t[t.exec=1]="exec",t[t.block=2]="block"}(StepType||(StepType={}));var Step=function(){function t(){this.m_taskList=[]}return t.prototype.wait=function(t){var e=this;return this.m_taskList.push({type:StepType.wait,data:t}),egret.setTimeout(function(){e.check()},this,0),this},t.prototype.exec=function(t,e){var i=this;return this.m_taskList.push({type:StepType.exec,data:{func:t,thisObj:e}}),egret.setTimeout(function(){i.check()},this,0),this},t.prototype.block=function(t,e){var i=this;return this.m_taskList.push({type:StepType.block,data:{func:t,thisObj:e}}),egret.setTimeout(function(){i.check()},this,0),this},t.prototype.next=function(){this.m_waitting=!1,egret.clearTimeout(this.m_timeId),this.check()},t.prototype.clear=function(){this.m_waitting=!1,egret.clearTimeout(this.m_timeId),this.m_taskList.length=0},t.prototype.check=function(){if(!this.m_waitting&&this.m_taskList.length>0){var t=this.m_taskList.shift();this.checkTask(t)}},t.prototype.checkTask=function(t){t.type==StepType.wait?this.doWait(t):t.type==StepType.exec?this.doExec(t):t.type==StepType.block&&this.doBlock(t)},t.prototype.doWait=function(t){var e=this,i=t.data;this.m_waitting=!0,this.m_timeId=egret.setTimeout(function(){e.m_waitting=!1,e.check()},this,i)},t.prototype.doExec=function(t){var e=t.data.func,i=t.data.thisObj;e.call(i),this.check()},t.prototype.doBlock=function(t){this.m_waitting=!0;var e=t.data.func,i=t.data.thisObj;e.call(i)},t}();__reflect(Step.prototype,"Step");var Workflow=function(){function t(){this.m_step=new Step,this.m_list=[]}return t.prototype.addWait=function(t){this.m_list.push({type:StepType.wait,data:t})},t.prototype.addExec=function(t,e){this.m_list.push({type:StepType.exec,data:{func:t,thisObj:e}})},t.prototype.addBlock=function(t,e){this.m_list.push({type:StepType.block,data:{func:t,thisObj:e}})},t.prototype.run=function(){this.m_step.clear();for(var t=0;t<this.m_list.length;t++){var e=this.m_list[t];e.type==StepType.wait?this.m_step.wait(e.data):e.type==StepType.exec?this.m_step.exec(e.func,e.thisObj):e.type==StepType.block&&this.m_step.block(e.func,e.thisObj)}},t.prototype.next=function(){this.m_step.next()},t}();__reflect(Workflow.prototype,"Workflow");var CountStars=function(t){function e(){var e=t.call(this)||this;return e.count=0,e.initContent(),e}return __extends(e,t),e.prototype.initContent=function(){var t=PublicTool.createBitmapByName("startBarBG_png");this.addChild(t);var i=PublicTool.createBitmapByName("startBar_png");this.addChild(i),this._topMask=new egret.Shape,this.addChild(this._topMask),this._topMask.graphics.beginFill(0,1),this._topMask.graphics.drawRect(0,0,e.MOVEDIS*e.NUM,51),this._topMask.graphics.endFill(),i.mask=this._topMask,this._topMask.x=(this.count-e.NUM)*e.MOVEDIS},e.prototype.add=function(){this.count>=10||(this.count++,this._topMask.x=(this.count-e.NUM)*e.MOVEDIS)},e.prototype.cut=function(){this.count<=0||(this.count--,this._topMask.x=(this.count-e.NUM)*e.MOVEDIS)},e.prototype.reset=function(){this.count=0,this._topMask.x=(this.count-e.NUM)*e.MOVEDIS},e.NUM=10,e.MOVEDIS=60,e}(egret.Sprite);__reflect(CountStars.prototype,"CountStars");var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},e.prototype.setProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var Main=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.resGroupName="scene",e.isThemeLoadEnd=!1,e.isResourceLoadEnd=!1,e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(t){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()};var e=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",e),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.loadingView=new LoadingUI,this.loadingView.x=(this.stage.stageWidth-this.loadingView.width)/2,this.loadingView.y=(this.stage.stageHeight-this.loadingView.height)/2,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},e.prototype.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var e=new eui.Theme("resource/default.thm.json",this.stage);e.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup(String(this.resGroupName))},e.prototype.onThemeLoadComplete=function(){this.isThemeLoadEnd=!0,this.createScene()},e.prototype.onResourceLoadComplete=function(t){RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onUnitLoadComplete,this);var e,i=GetRequestObject();return null==i?void Println("请求数据为null，无法加载相应单元的数据"):null==i.assetsName||void 0==i.assetsName||""==i.assetsName?void Println("请求的assetsName为null，无法加载相应单元的数据"):(e=i.assetsName,void RES.loadGroup(e))},e.prototype.onUnitLoadComplete=function(t){this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onUnitLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.isResourceLoadEnd=!0,this.createScene()},e.prototype.createScene=function(){this.isThemeLoadEnd&&this.isResourceLoadEnd&&this.startCreateScene()},e.prototype.onItemLoadError=function(t){console.warn("Url:"+t.resItem.url+" has failed to load")},e.prototype.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},e.prototype.onResourceProgress=function(t){t.groupName==this.resGroupName&&this.loadingView.setProgress(t.itemsLoaded,t.itemsTotal)},e.prototype.startCreateScene=function(){var t=new GraspTheDoll;this.addChild(t),this.topSP=new egret.Sprite,PublicTool.topSP=this.topSP,this.addChild(this.topSP)},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},e.prototype.startAnimation=function(t){var e=this,i=new egret.HtmlTextParser,s=t.map(function(t){return i.parse(t)}),n=this.textfield,o=-1,h=function(){o++,o>=s.length&&(o=0);var t=s[o];n.textFlow=t;var i=egret.Tween.get(n);i.to({alpha:1},200),i.wait(2e3),i.to({alpha:0},200),i.call(h,e)};h()},e.prototype.onButtonClick=function(t){var e=new eui.Panel;e.title="Title",e.horizontalCenter=0,e.verticalCenter=0,this.addChild(e)},e}(eui.UILayer);__reflect(Main.prototype,"Main");var SoundPlayer=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.exec=function(t,e){var i=this;return this.m_taskList.push({type:StepType.exec,data:{func:t,thisObj:e}}),egret.setTimeout(function(){i.check()},this,0),this},e.prototype.playRes=function(t,e,i){var s=this;void 0===e&&(e=1),void 0===i&&(i=1),Println("playRes key:"+t+" loop:"+e+" volume:"+i);var n={type:"playRes",data:{key:t,loop:e,volume:i}};return this.m_waitting?(this.m_taskList.push(n),egret.setTimeout(function(){s.check()},this,0)):this.doPlayRes(n),this},e.prototype.checkTask=function(e){t.prototype.checkTask.call(this,e),"playRes"==e.type&&this.doPlayRes(e)},e.prototype.doPlayRes=function(t){this.m_waitting=!0;var e=t.data.key;this._loop=t.data.loop,this._volume=t.data.volume,this.stopSound(),this._sound=RES.getRes(e),this._channel=this._sound.play(0,this._loop),this._channel.volume=this._volume,this._channel.addEventListener(egret.Event.SOUND_COMPLETE,this.onPlayComplete,this),Println("doPlayRes key:"+e+" sound:"+this._sound)},e.prototype.stopSound=function(){this._channel&&(this._channel.removeEventListener(egret.Event.SOUND_COMPLETE,this.onPlayComplete,this),this._channel.stop(),this._channel=null)},e.prototype.onPlayComplete=function(t){this.stopSound(),this.m_waitting=!1,this.check()},e.prototype.clear=function(){t.prototype.clear.call(this),this.stopSound()},e}(Step);__reflect(SoundPlayer.prototype,"SoundPlayer");var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,i){function s(s){e.call(i,s,t)}if(RES.hasRes(t)){var n=RES.getRes(t);n?s(n):RES.getResAsync(t,s,this)}else RES.getResByUrl(t,s,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,i,s){function n(t){e.call(s,t)}function o(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),i.call(s))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),RES.getResByUrl(t,n,this,RES.ResourceItem.TYPE_TEXT)},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var CardComponent=function(t){function e(e,i,s){var n=t.call(this)||this;return n.qID=s,n.initContent(e,i),n.once(egret.Event.REMOVED_FROM_STAGE,n.onREMOVED_FROM_STAGE,n),n}return __extends(e,t),e.prototype.initContent=function(t,e){this._bg=PublicTool.createBitmapByName("card"+t+"_png"),this.addChild(this._bg),this._img=e,this._img.x=.5*(this._bg.width-this._img.width),this._img.y=.5*(this._bg.height-this._img.height),this.addChild(this._img);var i=new egret.RenderTexture,s=new egret.Rectangle(0,0,this._bg.width,this._bg.height);i.drawToTexture(this,s),this._conSP=new egret.Bitmap,this._conSP.texture=i,this.removeChild(this._bg),this.removeChild(this._img),this.addChild(this._conSP),this.hitObj=new egret.Sprite,this.hitObj.graphics.beginFill(0,0),this.hitObj.graphics.drawRect(0,0,.5*this._bg.width,.5*this._bg.height),this.hitObj.graphics.endFill(),this.hitObj.x=.25*this._bg.width,this.hitObj.y=.25*this._bg.height,this.hitObj.cacheAsBitmap=!0,this.addChild(this.hitObj)},e.prototype.onREMOVED_FROM_STAGE=function(t){this._bg,this._img,this.removeChild(this.hitObj)},e}(egret.Sprite);__reflect(CardComponent.prototype,"CardComponent");var CountLoves=function(t){function e(){var e=t.call(this)||this;return e.count=3,e.createView(),e}return __extends(e,t),e.prototype.createView=function(){var t=this.createBitmapByName("heartBarBG_png");this.addChild(t);var i=this.createBitmapByName("heartBar_png");this.addChild(i),i.name="love",this._topMask=new egret.Shape,this.addChild(this._topMask),this._topMask.name="mask",this._topMask.graphics.beginFill(0,1),this._topMask.graphics.drawRect(0,0,e.MOVEDIS*e.NUM,51),this._topMask.graphics.endFill(),this._topMask.anchorOffsetX=-25,this._topMask.anchorOffsetY=-14,i.mask=this._topMask,this._topMask.x=(this.count-e.NUM)*e.MOVEDIS},e.prototype.add=function(){this.count>=e.NUM||(this.count++,this._topMask.x=(this.count-e.NUM)*e.MOVEDIS)},e.prototype.cut=function(){this.count<=0||(this.count--,this._topMask.x=(this.count-e.NUM)*e.MOVEDIS)},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},e.prototype.createDisobj=function(t){for(var e=new egret.Sprite,i=0;i<t.length;i++)e.addChild(t[i]);return e},e.prototype.reset=function(){this.count=e.NUM,this._topMask.x=(this.count-e.NUM)*e.MOVEDIS},e.MOVEDIS=74,e.NUM=3,e}(egret.Sprite);__reflect(CountLoves.prototype,"CountLoves");var GraspTheDoll=function(t){function e(){var e=t.call(this)||this;if(e.stage)e.initContent();else{var i=new egret.Timer(100,0);i.addEventListener(egret.TimerEvent.TIMER,e.timerFunc,e),i.start()}return e}return __extends(e,t),e.prototype.timerFunc=function(t){var e=this;this.stage&&(t.currentTarget.stop(),RES.getResAsync("bgmusic_mp3",function(t){e._bgSound=t,e.initContent()},this))},e.prototype.initContent=function(){PublicTool.stageWidth=this.stage.stageWidth,PublicTool.stageHeight=this.stage.stageHeight,this._bg=PublicTool.createBitmapByName("bg_png"),this._bg.width=PublicTool.stageWidth,this._bg.height=PublicTool.stageHeight,this.addChild(this._bg),this._hand=new HandComponent,this.addChild(this._hand),this._loves=new CountLoves,this.addChild(this._loves),this._loves.x=200,this._loves.y=16,this._stars=new CountStars,this.addChild(this._stars),this._stars.x=755,this._stars.y=24,this._question=new QuestionCompoment,this.addChild(this._question),this._leftBtn=new EButton(this,"leftBtn_png",this.onLeftBtnBegin,this.onLeftBtnEnd,"",30,3,null),PublicTool.setXY(this._leftBtn,345,864),this.addChild(this._leftBtn),this._rightBtn=new EButton(this,"rightBtn_png",this.onRightBtnBegin,this.onRightBtnEnd,"",30,3,null),PublicTool.setXY(this._rightBtn,850,864),this.addChild(this._rightBtn),this._getBtn=new EButton(this,"getBtn_png",this.onGetBtnClick,null,"",30,3,null),PublicTool.setXY(this._getBtn,605,828),this.addChild(this._getBtn),this._startBG=new egret.Sprite,this._startBG.graphics.beginFill(0,.5),this._startBG.graphics.drawRect(0,0,PublicTool.stageWidth,PublicTool.stageHeight),this._startBG.graphics.endFill(),this._startBG.touchEnabled=!0,this.addChild(this._startBG),this._next=new EButton(this,"next_png",null,null,"",30,3,null),this.addChild(this._next),this._next.$touchEnabled=!0,this._next.x=this.stage.stageWidth-this._next.width-50,this._next.y=880,this._next.visible=!1,this.m_repeatBtn=new EButton(this,"repeat_png",null,null,"",30,3,null),this.addChild(this.m_repeatBtn),this.m_repeatBtn.$touchEnabled=!0,this.m_repeatBtn.x=this._next.x,this.m_repeatBtn.y=this._next.y,this.m_repeatBtn.visible=!0,this.m_repeatBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.repeat,this),this._startBtn=new EButton(this,"start_png",null,null,"",30,3,null),this._startBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onStartBtnClick,this),this._startBtn.x=.5*(PublicTool.stageWidth-this._startBtn.width),this._startBtn.y=.5*(PublicTool.stageHeight-this._startBtn.height),this._startBG.addChild(this._startBtn),this._gameDone=PublicTool.createBitmapByName("gameDone_png"),this.addChild(this._gameDone),this._gameDone.visible=!1,this._gameDone.touchEnabled=!0,this._gameDone.alpha=0,this._gameOver=new egret.Sprite;var t=PublicTool.createBitmapByName("gameOver_png");this._gameOver.addChild(t);var e=new EButton(this,"tryAgain_png",null,this.resetCon,"",30,3,null);e.x=.5*(PublicTool.stageWidth-e.width),e.y=580,this._gameOver.addChild(e),this._gameOver.alpha=0,this._gameOver.visible=!1,this._gameOver.touchEnabled=!0,this.addChild(this._gameOver),this._hand.hitTestFun=this.hitTest,this._hand.endGraspFun=this.endGrasp},e.prototype.onStartBtnClick=function(t){this._bgChannel||(this._bgChannel=this._bgSound.play(0,0),this._bgChannel.volume=.5);var e=function(){this.showQuestion()};this._startBG.visible&&egret.Tween.get(this._startBG).to({alpha:0,visible:!1},800).call(e,this)},e.prototype.showQuestion=function(){this._question.createQuestion()},e.prototype.hitTest=function(t,e){var i=this._question.hitTestFun(t,e);i?this._stars.add():this._loves.cut(),this._loves.count<=0&&(this._isOver=!0,egret.Tween.get(this._gameOver).to({alpha:1,visible:!0},1e3),console.log("提交失败... ..."),GameOver(!1,function(){console.log("提交失败complete")}),this.m_repeatBtn.visible=!1),this._stars.count>=10&&(this._isOver=!0,egret.Tween.get(this._gameDone).to({alpha:1,visible:!0},1e3),console.log("提交胜利... ..."),GameOver(!0,function(){console.log("提交胜利complete")}),this._next.visible=0==GetRequestObject().taskId,this.m_repeatBtn.visible=!1)},e.prototype.endGrasp=function(){this._isOver||egret.setTimeout(this.showQuestion,this,2e3)},e.prototype.onLeftBtnBegin=function(t){this._hand.isTweening||(this._isRight=!1,this.addEventListener(egret.Event.ENTER_FRAME,this.onHandMove,this))},e.prototype.onLeftBtnEnd=function(t){this.removeEventListener(egret.Event.ENTER_FRAME,this.onHandMove,this)},e.prototype.onRightBtnBegin=function(t){this._hand.isTweening||(this._isRight=!0,this.addEventListener(egret.Event.ENTER_FRAME,this.onHandMove,this))},e.prototype.onRightBtnEnd=function(t){this.removeEventListener(egret.Event.ENTER_FRAME,this.onHandMove,this)},e.prototype.onHandMove=function(t){this._isRight?this._hand.rigth():this._hand.left()},e.prototype.onGetBtnClick=function(t){this._hand.startGrab()},e.prototype.resetCon=function(){this._stars.reset(),this._loves.reset(),this._question.createQuestion(),this._isOver=!1,this._gameOver.visible&&egret.Tween.get(this._gameOver).to({alpha:0,visible:!1},1e3),this.m_repeatBtn.visible=!0},e.prototype.repeat=function(t){this._question.repeat()},e}(egret.Sprite);__reflect(GraspTheDoll.prototype,"GraspTheDoll");var EButton=function(t){function e(e,i,s,n,o,h,r,a){void 0===s&&(s=null),void 0===n&&(n=null),void 0===o&&(o=""),void 0===h&&(h=30),void 0===r&&(r=1),void 0===a&&(a="assets");var l=t.call(this)||this;return l.assets=RES.getRes("assets"),l.isPlayCartoon=!1,l.cartoonType=1,l.param={context:null,data:null},l.param.context=e,l.init(i,s,n,o,h,r,a),l}return __extends(e,t),e.prototype.init=function(t,e,i,s,n,o,h){void 0===e&&(e=null),void 0===i&&(i=null),void 0===s&&(s=""),void 0===n&&(n=30),void 0===o&&(o=1),void 0===h&&(h="assets"),this.cartoonType=o,this.beginFun=e,this.endFun=i,this.btnImg=new egret.Bitmap,null==h?this.btnImg.texture=RES.getRes(t):("assets"!=h&&(this.assets=RES.getRes(h)),this.btnImg.texture=this.assets.getTexture(t)),this.addChild(this.btnImg),""!=s&&(this.textField=new egret.TextField,this.addChild(this.textField),this.textField.size=n,this.textField.textAlign="center",this.textField.stroke=1,this.textField.strokeColor=0,this.textField.text=s,this.textField.width=this.btnImg.width,this.textField.x=this.btnImg.width/2-this.textField.width/2,this.textField.y=this.btnImg.height/2-this.textField.height/2),this.touchEnabled=!0,this.touchChildren=!1,this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonBegin,this)},e.prototype.onButtonBegin=function(t){if(!this.isPlayCartoon){this.isPlayCartoon=!0,this.startX||(this.startX=this.x,this.startY=this.y);t.target;null!=this.beginFun&&this.beginFun.apply(this.param.context,[this.param.data]),this.stage.once(egret.TouchEvent.TOUCH_END,this.onButtonTouchEnd,this),egret.Tween.get(this).to({scaleX:.8,scaleY:.8,x:this.startX+.1*this.btnImg.width,y:this.startY+.1*this.btnImg.height},100,egret.Ease.sineIn)}},e.prototype.onButtonTouchEnd=function(t){var e=(t.target,function(){this.isPlayCartoon=!1,null!=this.endFun&&this.endFun.apply(this.param.context,[this.param.data])});1==this.cartoonType?egret.Tween.get(this).to({scaleX:1,scaleY:1,x:this.startX,y:this.startY},500,egret.Ease.elasticOut).call(e,this):2==this.cartoonType?egret.Tween.get(this).to({scaleX:1,scaleY:1,x:this.startX,y:this.startY},500,egret.Ease.backOut).call(e,this):3==this.cartoonType&&egret.Tween.get(this).to({scaleX:1,scaleY:1,x:this.startX,y:this.startY},100).call(e,this)},e.prototype.onbuttonTouchTap=function(t){if(!this.isPlayCartoon){this.isPlayCartoon=!0;var e=function(){this.isPlayCartoon=!1,null!=this.backFun&&this.backFun.apply(this.param.context,[this.param.data])},i=function(){1==this.cartoonType?egret.Tween.get(this).to({scaleX:1,scaleY:1,x:this.x-this.btnImg.width/4,y:this.y-this.btnImg.height/4},500,egret.Ease.elasticOut).call(e,this):2==this.cartoonType?egret.Tween.get(this).to({scaleX:1,scaleY:1,x:this.x-this.btnImg.width/4,y:this.y-this.btnImg.height/4},500,egret.Ease.backOut).call(e,this):3==this.cartoonType&&egret.Tween.get(this).to({scaleX:1,scaleY:1,x:this.x-this.btnImg.width/4,y:this.y-this.btnImg.height/4},100).call(e,this)};egret.Tween.get(this).to({scaleX:.5,scaleY:.5,x:this.x+this.btnImg.width/4,y:this.y+this.btnImg.height/4},100,egret.Ease.sineIn).call(i,this)}},e.prototype.setBindData=function(t){this.param.data=t},e.prototype.getBindData=function(){return this.param.data},e.prototype.getBitmap=function(){return this.btnImg},e}(egret.Sprite);__reflect(EButton.prototype,"EButton");var EffectUtils;!function(t){function e(t,e){if(void 0===e&&(e=1e3),null==this.rotationArr&&(this.rotationArr=[]),!this.rotationArr[t.hashCode]){null!=this.rotationArr[t.hashCode]&&this.rotationArr[t.hashCode]||(this.rotationArr[t.hashCode]=!0);var i=function(){this.rotationArr[t.hashCode]&&null!=t&&(t.rotation=0,egret.Tween.get(t).to({rotation:360},e).call(i,this))};t.rotation=0,egret.Tween.get(t).to({rotation:360},e).call(i,this)}}function i(t){null==this.rotationArr&&(this.rotationArr=[]),this.rotationArr[t.hashCode]=!1}function s(t,e){void 0===e&&(e=1e3),new BitmapBlink(t,e)}function n(t){var e=80,i=t.x;egret.Tween.get(t).to({x:t.x-10},e),egret.setTimeout(function(){egret.Tween.get(t).to({x:t.x+20},e)},this,2*e),egret.setTimeout(function(){egret.Tween.get(t).to({x:t.x-20},e)},this,3*e),egret.setTimeout(function(){egret.Tween.get(t).to({x:t.x+20},e)},this,4*e),egret.setTimeout(function(){egret.Tween.get(t).to({x:i},e)},this,5*e)}function o(t){void 0===t&&(t=1)}function h(t,e,i){switch(void 0===t&&(t=""),void 0===e&&(e=1),void 0===i&&(i=!1),e){case 1:TipsUtils.showTipsDownToUp(t,i);break;case 2:TipsUtils.showTipsLeftOrRight(t,i,!0);break;case 3:TipsUtils.showTipsLeftOrRight(t,i,!1);break;case 4:TipsUtils.showTipsFromCenter(t,i);break;case 5:TipsUtils.showTipsBigToSmall(t,i)}}function r(t,e){if(void 0===e&&(e=1),!this.isPlayEffectPlay){this.isPlayEffectPlay=!0;var i=function(){this.isPlayEffectPlay=!1},s=function(){1==e?egret.Tween.get(t).to({scaleX:1,scaleY:1,x:t.x-t.width/4,y:t.y-t.height/4},500,egret.Ease.elasticOut).call(i,this):2==e?egret.Tween.get(t).to({scaleX:1,scaleY:1,x:t.x-t.width/4,y:t.y-t.height/4},500,egret.Ease.backOut).call(i,this):3==e&&egret.Tween.get(t).to({scaleX:1,scaleY:1,x:t.x-t.width/4,y:t.y-t.height/4},100).call(i,this)};egret.Tween.get(t).to({scaleX:.5,scaleY:.5,x:t.x+t.width/4,y:t.y+t.height/4},100,egret.Ease.sineIn).call(s,this)}}function a(t){var e=function(){if(null!=t){var i=function(){t.scaleX=1,t.scaleY=1,egret.Tween.get(t).to({alpha:1},1e3).call(e,self)};t.alpha=1,egret.Tween.get(t).to({scaleX:1.5,scaleY:1.5,alpha:0},1e3).call(i,self)}};e()}function l(t,e,i){void 0===i&&(i=50);var s=function(){if(null!=t){var n=function(){egret.Tween.get(t).to({y:t.y-i},e).call(s,this)};egret.Tween.get(t).to({y:t.y+i},e).call(n,this)}};s()}function c(t,e,i){void 0===i&&(i=20);var s=function(){if(null!=t){var n=function(){egret.Tween.get(t).to({rotation:-i},e).call(s,this)};egret.Tween.get(t).to({rotation:i},e).call(n,this)}};s()}function p(t,e,i){void 0===e&&(e=""),void 0===i&&(i=200);for(var s=e.split(""),n=s.length,o=0;n>o;o++)egret.setTimeout(function(){t.appendText(s[Number(this)])},o,i*o)}t.rotationEffect=e,t.removeRotationEffect=i,t.blinkEffect=s,t.shakeObj=n,t.shakeScreen=o,t.showTips=h;t.playEffect=r,t.playScaleEffect=a,t.flyObj=l,t.rockObj=c,t.typerEffect=p}(EffectUtils||(EffectUtils={}));var ETextField=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setText=function(t){void 0===t&&(t="");var e=new egret.HtmlTextParser;this.textFlow=e.parser(t)},e}(egret.TextField);__reflect(ETextField.prototype,"ETextField");var HandComponent=function(t){function e(){var e=t.call(this)||this;return e.isTweening=!1,e.initContent(),e}return __extends(e,t),e.prototype.initContent=function(){var t=PublicTool.createBitmapByName("bar_png");t.x=66,t.y=160,this.addChild(t),this._handSP=new egret.Sprite,this._handSP.x=170,this._handSP.y=140,this.addChild(this._handSP),this._hand_mid=PublicTool.createBitmapByName("hand1_png"),this._hand_mid.x=40,this._hand_mid.y=30,this._handSP.addChild(this._hand_mid),this._hand_bottomSP=new egret.Sprite,this._handSP.addChild(this._hand_bottomSP);var e=PublicTool.createBitmapByName("hand3_png");e.x=-33,e.y=50,this._hand_bottomSP.addChild(e),this._hand2=PublicTool.createBitmapByName("hand2_png"),this._hand_bottomSP.addChild(this._hand2);var i=PublicTool.createBitmapByName("hand0_png");this._handSP.addChild(i),this.updata()},e.prototype.rigth=function(){this._handSP.x+=6,this._handSP.x>1170&&(this._handSP.x=1170)},e.prototype.left=function(){this._handSP.x-=6,this._handSP.x<90&&(this._handSP.x=90)},e.prototype.startGrab=function(){if(!this.isTweening){this.isTweening=!0;var t=function(){if(this.hitTestFun){var t=this._hand_bottomSP.localToGlobal(this._hand2.x+.5*this._hand2.width,this._hand2.y+.5*this._hand2.height);this.hitTestFun.apply(this.parent,[t.x,t.y])}egret.Tween.get(this._hand_mid,{onChange:this.updata,onChangeObj:this}).to({height:200},1e3,egret.Ease.quadInOut).call(this.endGrab,this)};egret.Tween.get(this._hand_mid,{onChange:this.updata,onChangeObj:this}).to({height:400},1e3,egret.Ease.quadOut).call(t,this)}},e.prototype.endGrab=function(){this.isTweening=!1,this.endGraspFun&&this.endGraspFun.apply(this.parent)},e.prototype.reset=function(){this.isTweening=!1},e.prototype.updata=function(){this._hand_bottomSP.x=this._hand_mid.x-33,this._hand_bottomSP.y=this._hand_mid.y+this._hand_mid.height-20},e}(egret.Sprite);__reflect(HandComponent.prototype,"HandComponent");var PublicTool=function(){function t(){}return t.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},t.setXY=function(t,e,i){t.x=e/this.resWidth*this.stageWidth,t.y=i/this.resHeight*this.stageHeight},t.resWidth=1366,t.resHeight=1024,t.TextColors={white:16777215,milkWhite:16511407,grayWhite:13547170,yellow:16776960,lightYellow:16765813,orangeYellow:16750848,red:15799040,green:58624,blue:1742039,grayBlue:3101047,purple:15284466,pink:16724016,black:3026221,golden:16766720},t}();__reflect(PublicTool.prototype,"PublicTool");var QuestionCompoment=function(t){function e(){var e=t.call(this)||this;return e._allList=new Array,e._imgList=new Array,e._qIDArr=new Array,e._nowIDArr=new Array,e._itemArr=new Array,e._answerID=-1,e.root="data/",e.resGroupName="unit1",e.isResourceLoadEnd=!1,e._isStart=!1,e.initContent(),e}return __extends(e,t),e.prototype.initContent=function(){this._gameData=RES.getRes("conf_json"),this.loadImg(),this.m_tipsSound=new SoundPlayer},e.prototype.loadImg=function(){for(var t=0;t<this._gameData.items.length;t++){var e=this._gameData.items[t].img,i=new egret.Bitmap(RES.getRes(e));i.width=i.height=150,i.name=String(t),this._imgList.push(i),this._qIDArr.push(t)}this._isStart&&this.createQuestion()},e.prototype.createQuestion=function(){this._isStart=!0;for(var t=250*this.numChildren,e=0;e<this.numChildren;e++)egret.Tween.get(this.getChildAt(e)).to({y:564,alpha:0},1e3,egret.Ease.quadInOut);egret.setTimeout(this.newQuestion,this,t)},e.prototype.newQuestion=function(){for(;this.numChildren>0;)this.removeChildAt(0);var t=this._qIDArr.slice();this._nowIDArr.length=0;for(var e=function(e){i._nowIDArr.push(i.getRandomArr(t));var s=i._nowIDArr[e],n=i._imgList[s],o=new CardComponent(e,n,s);o.name="item_"+s,o.x=120+308*e,o.y=514,o.alpha=0,o.y=564,i.addChild(o),egret.setTimeout(function(t){egret.Tween.get(o).to({y:514,alpha:1},1e3,egret.Ease.quadInOut)},i,100*e)},i=this,s=0;4>s&&s<this._qIDArr.length;s++)e(s);t=this._nowIDArr.slice(),-1!=t.indexOf(this._answerID)&&t.splice(t.indexOf(this._answerID),1),this._answerID=this.getRandomArr(t),this.repeat()},e.prototype.repeat=function(){this.m_tipsSound.clear(),this.m_tipsSound.playRes(this._gameData.items[this._answerID].audio)},e.prototype.hitTestFun=function(t,e){for(var i=!1,s=0;s<this._qIDArr.length;s++){var n=this.getChildByName("item_"+this._qIDArr[s]),o=n.hitObj.hitTestPoint(t,e,!1);o&&(n.name=="item_"+this._answerID&&(i=!0),egret.Tween.get(n).to({y:314},1e3,egret.Ease.quadInOut))}var h=this.getChildByName("item_"+this._qIDArr[this._answerID]);return EffectUtils.blinkEffect(h,2e3),i?EffectUtils.showTips("回答正確",4,!0):EffectUtils.showTips("回答錯誤",4),i},e.prototype.getRandomArr=function(t){return t.splice(Math.random()*t.length,1)[0]},e}(egret.Sprite);__reflect(QuestionCompoment.prototype,"QuestionCompoment");var BitmapBlink=function(t){function e(e,i,s){void 0===s&&(s=!0);var n=t.call(this)||this;return n._target=e,n._time=i,s&&n.start(),n}return __extends(e,t),e.prototype.start=function(){this._currTime=egret.getTimer(),this._target.addEventListener(egret.Event.ENTER_FRAME,this.runDown,this)},e.prototype.runDown=function(t){this._target.alpha-=.045,this.checkOver()||this._target.alpha<=.6&&(this._target.removeEventListener(egret.Event.ENTER_FRAME,this.runDown,this),this._target.addEventListener(egret.Event.ENTER_FRAME,this.runUp,this))},e.prototype.runUp=function(t){this._target.alpha+=.045,this.checkOver()||this._target.alpha>=1&&(this._target.removeEventListener(egret.Event.ENTER_FRAME,this.runUp,this),this._target.addEventListener(egret.Event.ENTER_FRAME,this.runDown,this))},e.prototype.checkOver=function(){var t=egret.getTimer();return t-this._currTime>=this._time?(this.destroy(),!0):!1},e.prototype.destroy=function(){this._target.alpha=1,this._target.removeEventListener(egret.Event.ENTER_FRAME,this.runDown,this),this._target.removeEventListener(egret.Event.ENTER_FRAME,this.runUp,this),this.dispatchEventWith(egret.Event.COMPLETE,!1,this._target),this._target=null},e}(egret.EventDispatcher);__reflect(BitmapBlink.prototype,"BitmapBlink");var TipsUtils;!function(t){function e(t,e){void 0===t&&(t=""),void 0===e&&(e=!1);var i=new egret.TextField;i.size=24,i.y=PublicTool.stageHeight/2,e?i.textColor=PublicTool.TextColors.red:i.textColor=PublicTool.TextColors.green,i.alpha=0,i.text=t,i.strokeColor=0,i.x=PublicTool.stageWidth/2-i.width/2,i.stroke=2,i.bold=!0,i.textAlign=egret.HorizontalAlign.CENTER,PublicTool.topSP.contains(i)||PublicTool.topSP.addChild(i);var s=function(){PublicTool.topSP.contains(i)&&(PublicTool.topSP.removeChild(i),i=null)},n=function(){egret.Tween.get(i).to({alpha:0},500).call(s,this)};i.visible=!0,egret.Tween.get(i).to({y:i.y-120,alpha:1},800,egret.Ease.backOut).call(n,this)}function i(t,e,i){void 0===t&&(t=""),void 0===e&&(e=!1),void 0===i&&(i=!0);var s=new egret.TextField;s.size=24,s.y=PublicTool.stageHeight/2,e?s.textColor=PublicTool.TextColors.red:s.textColor=PublicTool.TextColors.green,s.alpha=0,s.text=t,s.strokeColor=0,i?s.x=-s.width:s.x=PublicTool.stageWidth,s.stroke=2,s.bold=!0,s.textAlign=egret.HorizontalAlign.CENTER,PublicTool.topSP.contains(s)||PublicTool.topSP.addChild(s),i?egret.Tween.get(s).to({x:PublicTool.stageWidth/2-s.width/2-50,alpha:1},300,egret.Ease.sineInOut):egret.Tween.get(s).to({x:PublicTool.stageWidth/2-s.width/2+50,alpha:1},300,egret.Ease.sineInOut),egret.setTimeout(function(){i?egret.Tween.get(s).to({x:s.x+100},500):egret.Tween.get(s).to({x:s.x-100},500)},this,300),egret.setTimeout(function(){i?egret.Tween.get(s).to({x:PublicTool.stageWidth},300,egret.Ease.sineIn):egret.Tween.get(s).to({x:-s.width},300,egret.Ease.sineIn)},this,800),egret.setTimeout(function(){PublicTool.topSP.contains(s)&&(PublicTool.topSP.removeChild(s),s=null)},this,1100)}function s(t,e){void 0===t&&(t=""),void 0===e&&(e=!1);var i=new egret.TextField;i.size=44,i.y=PublicTool.stageHeight/2-150,e?i.textColor=PublicTool.TextColors.white:i.textColor=PublicTool.TextColors.golden,i.alpha=0,i.text=t,i.strokeColor=0,i.x=PublicTool.stageWidth/2,i.stroke=2,i.bold=!0,i.textAlign=egret.HorizontalAlign.CENTER,PublicTool.topSP.contains(i)||PublicTool.topSP.addChild(i),i.anchorOffsetX=i.width/2,i.anchorOffsetY=i.height/2,i.scaleX=0,i.scaleY=0;
var s=function(){PublicTool.topSP.contains(i)&&(PublicTool.topSP.removeChild(i),i=null)};egret.Tween.get(i).to({scaleX:1,scaleY:1,alpha:1},200),egret.setTimeout(function(){egret.Tween.get(i).to({alpha:0},500).call(s,this)},this,1e3)}function n(t,e){void 0===t&&(t=""),void 0===e&&(e=!1);var i=new egret.TextField;i.size=24,i.y=PublicTool.stageHeight/2,e?i.textColor=PublicTool.TextColors.red:i.textColor=PublicTool.TextColors.green,i.alpha=0,i.text=t,i.strokeColor=0,i.x=PublicTool.stageWidth/2,i.stroke=2,i.bold=!0,i.textAlign=egret.HorizontalAlign.CENTER,PublicTool.topSP.contains(i)||PublicTool.topSP.addChild(i),i.anchorOffsetX=i.width/2,i.anchorOffsetY=i.height/2,i.scaleX=4,i.scaleY=4;var s=function(){PublicTool.topSP.contains(i)&&(PublicTool.topSP.removeChild(i),i=null)};egret.Tween.get(i).to({scaleX:1,scaleY:1,alpha:1},200),egret.setTimeout(function(){egret.Tween.get(i).to({alpha:0},500).call(s,this)},this,1e3)}t.showTipsDownToUp=e,t.showTipsLeftOrRight=i,t.showTipsFromCenter=s,t.showTipsBigToSmall=n}(TipsUtils||(TipsUtils={}));